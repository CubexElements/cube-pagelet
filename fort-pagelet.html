<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">

<!--
An element to load a url into a container

Example:

    <fort-pagelet url="./ajax.html" refresh="3">Loading Placeholder</fort-pagelet>

@demo demo/index.html
-->

<dom-module id="fort-pagelet">
  <template strip-whitespace>
    <iron-ajax auto url="[[url]]" last-response="{{content}}"
               on-response="handleResponse"
               handle-as="document" id="request"></iron-ajax>
    <div id="ajax">
      <content></content>
    </div>
  </template>

  <script>
    Polymer(
      {
        is:             'fort-pagelet',
        properties:     {
          /**
           * URL you want to be loaded into the container
           */
          url:     String,
          /**
           * Number of seconds to refresh the url
           */
          refresh: Number
        },
        handleResponse: function (data)
                        {
                          this.$.ajax.innerHTML = data.detail.response.body.innerHTML
                        },
        attached:       function ()
                        {
                          var self = this;
                          if(self.refresh)
                          {
                            this.refreshInterval = setInterval(
                              function ()
                              {
                                self.$.request.generateRequest();
                              },
                              self.refresh * 1000
                            );
                          }
                        },
        detached:       function ()
                        {
                          if(this.refreshInterval)
                          {
                            clearInterval(this.refreshInterval);
                          }
                        }
      }
    );
  </script>
</dom-module>
